import{d as L,u as B,r as d,c as k,o as F,g as D,F as w,f as r,i as a,e as c,C as R,I as U,H as $,G as f,A as I,E as N,L as j}from"./auth-Vb-AA__w.js";import{a as O,u as G}from"./preload-helper-DQNYPBmD.js";import{A as q}from"./chrome-mock-DxZfNgLw.js";import{R as H}from"./ResponsiveLayout-D_dkxory.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"confirm-container"},z={class:"input-section"},K={class:"word-grid"},Q={class:"word-number"},X=["onUpdate:modelValue","placeholder"],Z={class:"action-buttons"},ee=["disabled"],ae={key:0,class:"ri-loader-4-line animate-spin"},se={key:1,class:"ri-clipboard-line"},te={class:"password-section"},oe={class:"password-inputs"},le={class:"input-group"},ne={key:0,class:"error-message"},re={class:"bottom-section"},ie=["disabled"],de={key:0,class:"ri-loader-4-line animate-spin"},ce={key:1,class:"ri-add-line"},ue=L({__name:"ConfirmMnemonic",setup(pe){const g=G(),S=B(),l=O(),i=d(Array(12).fill("")),u=d(""),m=d(!1),p=d(!1),s=d(""),y=d(""),h=d(""),b=k(()=>i.value.every(t=>t.trim().length>0)),_=k(()=>u.value.length>=6),C=()=>{g.go(-1)},P=()=>{s.value=""},W=()=>{if(s.value="",u.value.length>0&&u.value.length<6){s.value="Password must be at least 6 characters";return}},E=async()=>{if(!p.value)try{if(p.value=!0,s.value="",!navigator.clipboard){s.value="Clipboard API not supported. Please type your seed phrase manually.";return}try{if((await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){s.value="Clipboard access denied. Please allow clipboard permissions in your browser settings or type manually.";return}}catch{console.log("Permission check not supported, proceeding with clipboard read")}const t=await navigator.clipboard.readText();A(t)}catch(t){console.error("Clipboard error:",t),t.name==="NotAllowedError"?s.value="Clipboard access denied. Please allow clipboard permissions or type manually.":t.name==="NotFoundError"?s.value="No text found in clipboard. Please copy your seed phrase first.":t.name==="SecurityError"?s.value="Clipboard access blocked by security policy. Please type your seed phrase manually.":s.value="Failed to read from clipboard. Please type your seed phrase manually."}finally{p.value=!1}},A=t=>{if(!t||!t.trim()){s.value="No text found in clipboard. Please copy your seed phrase first.";return}const e=t.trim().split(/\s+/).filter(n=>n.length>0);e.length===12?(i.value=e.map(n=>n.toLowerCase().trim()),P(),setTimeout(()=>{s.value},100)):e.length>12?s.value=`Too many words (${e.length}). Please paste exactly 12 words.`:e.length>0?s.value=`Not enough words (${e.length}). Please paste exactly 12 words.`:s.value="Invalid seed phrase format. Please paste 12 words separated by spaces."},M=()=>{i.value=Array(12).fill(""),s.value=""},V=async()=>{if(!(!b.value||!_.value))try{s.value="",m.value=!0;const t=i.value.join(" ").toLowerCase(),e=y.value.toLowerCase();if(t!==e){s.value="The seed phrase you entered does not match. Please try again.";return}const n=await fetch(`${q.API_BASE_URL}/wallets/verify_mnemonic/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_id:S.deviceId,chain:h.value,mnemonic:t,payment_password:u.value})}),o=await n.json();if(!n.ok||o.state!=="success")throw new Error(o.message||"Failed to verify mnemonic");if(o.data&&o.data.success)if(console.log("✅ Wallet verification successful, reloading wallets..."),await l.loadWallets(),console.log("📋 Wallets loaded:",l.wallets.length),l.wallets.length>0){if(o.data.wallet&&o.data.wallet.id){console.log("🔍 Looking for wallet with ID:",o.data.wallet.id);const v=l.wallets.find(x=>x.id===o.data.wallet.id);v?(console.log("✅ Found new wallet, setting as current:",v.name),await l.setCurrentWallet(v)):(console.log("❌ New wallet not found, selecting first wallet"),await l.setCurrentWallet(l.wallets[0]))}else console.log("📝 No wallet ID in response, selecting first wallet"),await l.setCurrentWallet(l.wallets[0]);console.log("🎯 Current wallet set:",l.currentWallet?.name)}else console.log("❌ No wallets found after reload");sessionStorage.removeItem("generated_mnemonic"),sessionStorage.removeItem("selected_chain"),console.log("🧹 Temporary data cleared"),console.log("🚀 Navigating to home page..."),g.push("/"),console.log("✅ Navigation initiated")}catch(t){s.value=t instanceof Error?t.message:"Verification failed"}finally{m.value=!1}},T=()=>{const t=sessionStorage.getItem("generated_mnemonic"),e=sessionStorage.getItem("selected_chain");t&&e?(y.value=t,h.value=e):s.value="No mnemonic data found. Please go back and start over."};return F(()=>{T()}),(t,e)=>(r(),D(H,{title:"Confirm Seed Phrase","show-header":!0,"show-footer":!0,scrollable:!0,padding:"16px",onBack:C},{header:w(()=>[a("div",{class:"page-header"},[a("div",{class:"header-left"},[a("button",{onClick:C,class:"back-button"},e[1]||(e[1]=[a("i",{class:"ri-arrow-left-line"},null,-1)])),e[2]||(e[2]=a("h1",{class:"header-title"},"Confirm Seed Phrase",-1))])])]),footer:w(()=>[a("div",re,[a("button",{class:"confirm-btn",disabled:!b.value||!_.value||m.value,onClick:V},[m.value?(r(),c("i",de)):(r(),c("i",ce)),a("span",null,f(m.value?"Creating Wallet...":"Create Wallet"),1)],8,ie)])]),default:w(()=>[a("div",Y,[e[8]||(e[8]=a("div",{class:"header-section"},[a("h2",null,"Verify Recovery Phrase"),a("p",null,"Enter your 12-word recovery phrase to confirm you've saved it correctly.")],-1)),a("div",z,[a("div",K,[(r(!0),c($,null,U(i.value,(n,o)=>(r(),c("div",{key:o,class:"word-input-item"},[a("span",Q,f(o+1),1),I(a("input",{"onUpdate:modelValue":v=>i.value[o]=v,type:"text",placeholder:`Word ${o+1}`,class:"word-input",onInput:P,autocomplete:"off",spellcheck:"false"},null,40,X),[[N,i.value[o]]])]))),128))]),a("div",Z,[a("button",{class:"paste-btn",onClick:E,disabled:p.value},[p.value?(r(),c("i",ae)):(r(),c("i",se)),a("span",null,f(p.value?"Pasting...":"Paste from Clipboard"),1)],8,ee),a("button",{class:"clear-btn",onClick:M},e[3]||(e[3]=[a("i",{class:"ri-delete-bin-line"},null,-1),a("span",null,"Clear All",-1)]))])]),a("div",te,[e[5]||(e[5]=a("h3",null,"Verify Your Password",-1)),e[6]||(e[6]=a("p",null,"Enter your wallet password to create the wallet",-1)),a("div",oe,[a("div",le,[e[4]||(e[4]=a("label",null,"Password",-1)),I(a("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),type:"password",placeholder:"Enter your wallet password",class:"password-input",onInput:W},null,544),[[N,u.value]])])])]),s.value?(r(),c("div",ne,[e[7]||(e[7]=a("i",{class:"ri-error-warning-line"},null,-1)),j(" "+f(s.value),1)])):R("",!0)])]),_:1}))}}),ye=J(ue,[["__scopeId","data-v-ed537deb"]]);export{ye as default};
