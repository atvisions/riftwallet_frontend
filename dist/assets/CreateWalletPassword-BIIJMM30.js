import{d as A,f as E,b as n,c as N,o as D,k as u,q as s,A as y,y as x,M as B,E as C,D as b,I as m,l as w}from"./main-Bf4zo9mQ.js";import{a as F,u as M}from"./popup-TD7wOOC_.js";import{A as O}from"./index-DcL2QsEm.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./chrome-mock-B1Y85l16.js";const V={class:"create-wallet-password-page"},R={class:"content"},T={class:"password-section"},j={class:"input-group"},J={class:"input-wrapper"},L=["type"],$={key:0,class:"error-message"},q={key:0,class:"error-message"},z={class:"footer"},G=["disabled"],Y={key:0},H={key:1},K=A({__name:"CreateWalletPassword",setup(Q){const g=M(),W=E(),t=F(),r=n(""),p=n(!1),i=n(""),v=n(!1),c=n(""),f=n(""),h=n(""),_=N(()=>r.value.length>=8&&!i.value),k=()=>{g.go(-1)},I=()=>{i.value="",r.value.length>0&&r.value.length<8&&(i.value="Password must be at least 8 characters long")},P=async()=>{if(_.value)try{v.value=!0,c.value="";const e=await(await fetch(`${O.API_BASE_URL}/wallets/verify_mnemonic/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_id:W.deviceId,chain:h.value,mnemonic:f.value,payment_password:r.value})})).json();if(e.state==="success"){sessionStorage.removeItem("generated_mnemonic"),sessionStorage.removeItem("selected_chain"),sessionStorage.removeItem("verified_mnemonic"),console.log("ðŸŽ‰ Wallet created successfully:",e),console.log("ðŸ“Š API response data:",JSON.stringify(e,null,2));const a=e.data;if(console.log("ðŸ†• New wallet data from API:",a),t.currentWallet=null,console.log("ðŸ”„ Reloading wallet list..."),await t.loadWallets(!1),console.log("ðŸ“‹ Current wallet list after reload:",t.wallets.map(l=>({id:l.id,name:l.name,chain:l.chain,address:l.address.substring(0,10)+"..."}))),a&&a.id){console.log("ðŸ” Looking for wallet with ID:",a.id);const l=t.wallets.find(d=>d.id===a.id);if(l)console.log("âœ… Found created wallet:",l),await t.setCurrentWallet(l),console.log("ðŸŽ¯ New wallet set as current:",l.id,l.chain,l.name);else if(console.warn("âŒ Created wallet not found in wallet list"),console.log("ðŸ” Available wallet IDs:",t.wallets.map(d=>d.id)),t.wallets.length>0){const d=t.wallets[t.wallets.length-1];console.log("ðŸ“Œ Using latest wallet as fallback:",d),await t.setCurrentWallet(d)}}else if(console.warn("âŒ No wallet data in response"),console.log("ðŸ“„ Full response:",e),t.wallets.length>0){const l=t.wallets[t.wallets.length-1];console.log("ðŸ“Œ Using latest wallet as fallback:",l),await t.setCurrentWallet(l)}console.log("ðŸ  Current wallet before redirect:",t.currentWallet),g.push("/")}else throw new Error(e.message||"Failed to create wallet")}catch(o){c.value=o instanceof Error?o.message:"Failed to create wallet"}finally{v.value=!1}},S=()=>{const o=sessionStorage.getItem("verified_mnemonic"),e=sessionStorage.getItem("selected_chain");if(!o||!e){c.value="Missing wallet creation data. Please start over.";return}f.value=o,h.value=e};return D(()=>{S()}),(o,e)=>(w(),u("div",V,[s("div",{class:"header"},[s("button",{class:"back-btn",onClick:k},e[2]||(e[2]=[s("i",{class:"ri-arrow-left-line"},null,-1)])),e[3]||(e[3]=s("h1",null,"Create Wallet",-1)),e[4]||(e[4]=s("div",{class:"placeholder"},null,-1))]),s("div",R,[e[7]||(e[7]=s("div",{class:"description"},[s("h2",null,"Enter Your Password"),s("p",null,"Enter your payment password to create the wallet with the verified seed phrase.")],-1)),s("div",T,[s("div",j,[e[5]||(e[5]=s("label",{for:"password"},"Payment Password",-1)),s("div",J,[x(s("input",{id:"password","onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),type:p.value?"text":"password",placeholder:"Enter your password",class:C(["password-input",{error:i.value}]),onInput:I,autofocus:""},null,42,L),[[B,r.value]]),s("button",{type:"button",onClick:e[1]||(e[1]=a=>p.value=!p.value),class:"toggle-password"},[s("i",{class:C(p.value?"ri-eye-off-line":"ri-eye-line")},null,2)])]),i.value?(w(),u("div",$,b(i.value),1)):y("",!0)])]),c.value?(w(),u("div",q,[e[6]||(e[6]=s("i",{class:"ri-error-warning-line"},null,-1)),m(" "+b(c.value),1)])):y("",!0)]),s("div",z,[s("button",{class:"create-btn",disabled:!_.value||v.value,onClick:P},[v.value?(w(),u("span",Y,e[8]||(e[8]=[s("i",{class:"ri-loader-4-line animate-spin"},null,-1),m(" Creating Wallet... ")]))):(w(),u("span",H,e[9]||(e[9]=[m(" Create Wallet "),s("i",{class:"ri-check-line"},null,-1)])))],8,G)])]))}}),le=U(K,[["__scopeId","data-v-3e20fa44"]]);export{le as default};
