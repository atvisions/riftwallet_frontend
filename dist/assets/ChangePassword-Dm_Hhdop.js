import{d as q,u as E,r as t,c as k,w as S,e as v,m as B,i as e,C as p,A as b,L as C,n,G as m,J as N,f as w}from"./auth-DQh_hvla.js";import{u as F}from"./preload-helper-gab_YaoT.js";import{A as O}from"./chrome-mock-wjw8bMAV.js";import{P as T}from"./PageHeader-CwFKyMAW.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"change-password-page"},R={class:"content"},j={class:"password-form"},G={class:"form-group"},J={class:"password-input-container"},L=["type"],M={key:0,class:"error-message"},z={class:"form-group"},H={class:"password-input-container"},K=["type"],Q={key:0,class:"error-message"},W={class:"form-group"},X={class:"password-input-container"},Y=["type"],Z={key:0,class:"error-message"},ss={class:"password-requirements"},es={class:"requirements-list"},as={key:0,class:"general-error"},os={key:1,class:"success-message"},rs={class:"form-actions"},ls=["disabled"],ts={key:0,class:"ri-loader-4-line animate-spin"},ns=q({__name:"ChangePassword",setup(is){const V=F(),x=E(),i=t(""),o=t(""),u=t(""),P=t(!1),g=t(!1),y=t(!1),f=t(!1),d=t(""),_=t(""),a=t({oldPassword:"",newPassword:"",confirmPassword:""}),c=k(()=>({length:o.value.length>=6,number:/\d/.test(o.value)})),A=k(()=>i.value.length>0&&o.value.length>=6&&u.value===o.value&&c.value.length&&c.value.number),h=r=>{a.value[r]="",d.value=""},I=()=>{let r=!0;return a.value={oldPassword:"",newPassword:"",confirmPassword:""},i.value||(a.value.oldPassword="Current password is required",r=!1),o.value?o.value.length<6?(a.value.newPassword="Password must be at least 6 characters",r=!1):/\d/.test(o.value)||(a.value.newPassword="Password must contain at least one number",r=!1):(a.value.newPassword="New password is required",r=!1),u.value?u.value!==o.value&&(a.value.confirmPassword="Passwords do not match",r=!1):(a.value.confirmPassword="Please confirm your new password",r=!1),i.value&&o.value&&i.value===o.value&&(a.value.newPassword="New password must be different from current password",r=!1),r},$=async()=>{if(I())try{f.value=!0,d.value="",_.value="";const r=await fetch(`${O.API_BASE_URL}/wallets/change_password/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_id:x.deviceId,old_password:i.value,new_password:o.value,confirm_password:u.value})}),s=await r.json();r.ok&&s.state==="success"?(_.value="Password changed successfully!",i.value="",o.value="",u.value="",setTimeout(()=>{V.push("/settings")},2e3)):s.message?d.value=s.message:s.error?d.value=s.error:d.value="Failed to change password. Please try again."}catch(r){console.error("Change password error:",r),d.value="Network error. Please check your connection and try again."}finally{f.value=!1}};return S(o,()=>{a.value.confirmPassword&&u.value===o.value&&(a.value.confirmPassword="")}),(r,s)=>(w(),v("div",D,[B(T,{title:"Change Password"}),e("div",R,[e("div",j,[e("div",G,[s[9]||(s[9]=e("label",{class:"form-label"},"Current Password",-1)),e("div",J,[b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>i.value=l),type:P.value?"text":"password",class:n(["form-input",{error:a.value.oldPassword}]),placeholder:"Enter current password",onInput:s[1]||(s[1]=l=>h("oldPassword"))},null,42,L),[[C,i.value]]),e("button",{type:"button",class:"password-toggle",onClick:s[2]||(s[2]=l=>P.value=!P.value)},[e("i",{class:n(P.value?"ri-eye-off-line":"ri-eye-line")},null,2)])]),a.value.oldPassword?(w(),v("div",M,m(a.value.oldPassword),1)):p("",!0)]),e("div",z,[s[10]||(s[10]=e("label",{class:"form-label"},"New Password",-1)),e("div",H,[b(e("input",{"onUpdate:modelValue":s[3]||(s[3]=l=>o.value=l),type:g.value?"text":"password",class:n(["form-input",{error:a.value.newPassword}]),placeholder:"Enter new password",onInput:s[4]||(s[4]=l=>h("newPassword"))},null,42,K),[[C,o.value]]),e("button",{type:"button",class:"password-toggle",onClick:s[5]||(s[5]=l=>g.value=!g.value)},[e("i",{class:n(g.value?"ri-eye-off-line":"ri-eye-line")},null,2)])]),a.value.newPassword?(w(),v("div",Q,m(a.value.newPassword),1)):p("",!0)]),e("div",W,[s[11]||(s[11]=e("label",{class:"form-label"},"Confirm New Password",-1)),e("div",X,[b(e("input",{"onUpdate:modelValue":s[6]||(s[6]=l=>u.value=l),type:y.value?"text":"password",class:n(["form-input",{error:a.value.confirmPassword}]),placeholder:"Confirm new password",onInput:s[7]||(s[7]=l=>h("confirmPassword"))},null,42,Y),[[C,u.value]]),e("button",{type:"button",class:"password-toggle",onClick:s[8]||(s[8]=l=>y.value=!y.value)},[e("i",{class:n(y.value?"ri-eye-off-line":"ri-eye-line")},null,2)])]),a.value.confirmPassword?(w(),v("div",Z,m(a.value.confirmPassword),1)):p("",!0)]),e("div",ss,[s[14]||(s[14]=e("div",{class:"requirements-title"},"Password Requirements:",-1)),e("ul",es,[e("li",{class:n({valid:c.value.length})},[e("i",{class:n(c.value.length?"ri-check-line":"ri-close-line")},null,2),s[12]||(s[12]=N(" At least 6 characters "))],2),e("li",{class:n({valid:c.value.number})},[e("i",{class:n(c.value.number?"ri-check-line":"ri-close-line")},null,2),s[13]||(s[13]=N(" Contains numbers "))],2)])]),d.value?(w(),v("div",as,m(d.value),1)):p("",!0),_.value?(w(),v("div",os,m(_.value),1)):p("",!0),e("div",rs,[e("button",{class:"btn btn-primary",onClick:$,disabled:!A.value||f.value},[f.value?(w(),v("i",ts)):p("",!0),e("span",null,m(f.value?"Changing...":"Change Password"),1)],8,ls)])])])]))}}),ps=U(ns,[["__scopeId","data-v-1505a556"]]);export{ps as default};
