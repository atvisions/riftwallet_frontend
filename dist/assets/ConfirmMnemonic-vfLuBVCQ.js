import{d as L,u as B,r as d,c as k,o as F,g as D,F as g,f as r,i as a,e as c,C as R,I as U,A as I,G as f,E as N,H as $,J as j}from"./auth-DRfzTYJF.js";import{a as O,u as G}from"./preload-helper-DtVLuan9.js";import{A as J}from"./chrome-mock-0jeXDaAI.js";import{R as q}from"./ResponsiveLayout-NikCG07L.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"confirm-container"},z={class:"input-section"},K={class:"word-grid"},Q={class:"word-number"},X=["onUpdate:modelValue","placeholder"],Z={class:"action-buttons"},ee=["disabled"],ae={key:0,class:"ri-loader-4-line animate-spin"},oe={key:1,class:"ri-clipboard-line"},se={class:"password-section"},te={class:"password-inputs"},le={class:"input-group"},ne={key:0,class:"error-message"},re={class:"bottom-section"},ie=["disabled"],de={key:0,class:"ri-loader-4-line animate-spin"},ce={key:1,class:"ri-add-line"},ue=L({__name:"ConfirmMnemonic",setup(pe){const w=G(),S=B(),l=O(),i=d(Array(12).fill("")),u=d(""),m=d(!1),p=d(!1),s=d(""),y=d(""),h=d(""),b=k(()=>i.value.every(o=>o.trim().length>0)),_=k(()=>u.value.length>=6),C=()=>{w.go(-1)},P=()=>{s.value=""},W=()=>{if(s.value="",u.value.length>0&&u.value.length<6){s.value="Password must be at least 6 characters";return}},E=async()=>{if(!p.value)try{if(p.value=!0,s.value="",!navigator.clipboard){s.value="Clipboard API not supported. Please type your seed phrase manually.";return}try{if((await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){s.value="Clipboard access denied. Please allow clipboard permissions in your browser settings or type manually.";return}}catch{console.log("Permission check not supported, proceeding with clipboard read")}const o=await navigator.clipboard.readText();console.log("Clipboard content:",o),A(o)}catch(o){console.error("Clipboard error:",o),o.name==="NotAllowedError"?s.value="Clipboard access denied. Please allow clipboard permissions or type manually.":o.name==="NotFoundError"?s.value="No text found in clipboard. Please go back to the previous page and copy your seed phrase first.":o.name==="SecurityError"?s.value="Clipboard access blocked by security policy. Please type your seed phrase manually.":s.value="Failed to read from clipboard. Please go back and copy your seed phrase, or type manually."}finally{p.value=!1}},A=o=>{if(!o||!o.trim()){s.value="No text found in clipboard. Please go back to the previous page and copy your seed phrase first.";return}const e=o.trim().split(/\s+/).filter(n=>n.length>0);console.log("Pasted text:",o),console.log("Parsed words:",e),e.length===12?(i.value=e.map(n=>n.toLowerCase().trim()),P(),s.value="",setTimeout(()=>{s.value||console.log("Successfully pasted 12 words")},100)):e.length>12?s.value=`Too many words (${e.length}). Please paste exactly 12 words.`:e.length>0?s.value=`Not enough words (${e.length}). Please paste exactly 12 words.`:s.value="Invalid seed phrase format. Please paste 12 words separated by spaces."},M=()=>{i.value=Array(12).fill(""),s.value=""},V=async()=>{if(!(!b.value||!_.value))try{s.value="",m.value=!0;const o=i.value.join(" ").toLowerCase(),e=y.value.toLowerCase();if(o!==e){s.value="The seed phrase you entered does not match. Please try again.";return}const n=await fetch(`${J.API_BASE_URL}/wallets/verify_mnemonic/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_id:S.deviceId,chain:h.value,mnemonic:o,payment_password:u.value})}),t=await n.json();if(!n.ok||t.state!=="success")throw new Error(t.message||"Failed to verify mnemonic");if(t.data&&t.data.success)if(console.log("âœ… Wallet verification successful, reloading wallets..."),await l.loadWallets(),console.log("ðŸ“‹ Wallets loaded:",l.wallets.length),l.wallets.length>0){if(t.data.wallet&&t.data.wallet.id){console.log("ðŸ” Looking for wallet with ID:",t.data.wallet.id);const v=l.wallets.find(x=>x.id===t.data.wallet.id);v?(console.log("âœ… Found new wallet, setting as current:",v.name),await l.setCurrentWallet(v)):(console.log("âŒ New wallet not found, selecting first wallet"),await l.setCurrentWallet(l.wallets[0]))}else console.log("ðŸ“ No wallet ID in response, selecting first wallet"),await l.setCurrentWallet(l.wallets[0]);console.log("ðŸŽ¯ Current wallet set:",l.currentWallet?.name)}else console.log("âŒ No wallets found after reload");sessionStorage.removeItem("generated_mnemonic"),sessionStorage.removeItem("selected_chain"),console.log("ðŸ§¹ Temporary data cleared"),console.log("ðŸš€ Navigating to home page..."),w.push("/"),console.log("âœ… Navigation initiated")}catch(o){s.value=o instanceof Error?o.message:"Verification failed"}finally{m.value=!1}},T=()=>{const o=sessionStorage.getItem("generated_mnemonic"),e=sessionStorage.getItem("selected_chain");o&&e?(y.value=o,h.value=e):s.value="No mnemonic data found. Please go back and start over."};return F(()=>{T()}),(o,e)=>(r(),D(q,{title:"Confirm Seed Phrase","show-header":!0,"show-footer":!0,scrollable:!0,padding:"16px",onBack:C},{header:g(()=>[a("div",{class:"page-header"},[a("div",{class:"header-left"},[a("button",{onClick:C,class:"back-button"},e[1]||(e[1]=[a("i",{class:"ri-arrow-left-line"},null,-1)])),e[2]||(e[2]=a("h1",{class:"header-title"},"Confirm Seed Phrase",-1))])])]),footer:g(()=>[a("div",re,[a("button",{class:"confirm-btn",disabled:!b.value||!_.value||m.value,onClick:V},[m.value?(r(),c("i",de)):(r(),c("i",ce)),a("span",null,f(m.value?"Creating Wallet...":"Create Wallet"),1)],8,ie)])]),default:g(()=>[a("div",Y,[e[8]||(e[8]=a("div",{class:"header-section"},[a("h2",null,"Verify Recovery Phrase"),a("p",null,"Enter your 12-word recovery phrase to confirm you've saved it correctly.")],-1)),a("div",z,[a("div",K,[(r(!0),c($,null,U(i.value,(n,t)=>(r(),c("div",{key:t,class:"word-input-item"},[a("span",Q,f(t+1),1),I(a("input",{"onUpdate:modelValue":v=>i.value[t]=v,type:"text",placeholder:`Word ${t+1}`,class:"word-input",onInput:P,autocomplete:"off",spellcheck:"false"},null,40,X),[[N,i.value[t]]])]))),128))]),a("div",Z,[a("button",{class:"paste-btn",onClick:E,disabled:p.value},[p.value?(r(),c("i",ae)):(r(),c("i",oe)),a("span",null,f(p.value?"Pasting...":"Paste from Clipboard"),1)],8,ee),a("button",{class:"clear-btn",onClick:M},e[3]||(e[3]=[a("i",{class:"ri-delete-bin-line"},null,-1),a("span",null,"Clear All",-1)]))])]),a("div",se,[e[5]||(e[5]=a("h3",null,"Verify Your Password",-1)),e[6]||(e[6]=a("p",null,"Enter your wallet password to create the wallet",-1)),a("div",te,[a("div",le,[e[4]||(e[4]=a("label",null,"Password",-1)),I(a("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),type:"password",placeholder:"Enter your wallet password",class:"password-input",onInput:W},null,544),[[N,u.value]])])])]),s.value?(r(),c("div",ne,[e[7]||(e[7]=a("i",{class:"ri-error-warning-line"},null,-1)),j(" "+f(s.value),1)])):R("",!0)])]),_:1}))}}),ye=H(ue,[["__scopeId","data-v-0711a9f9"]]);export{ye as default};
