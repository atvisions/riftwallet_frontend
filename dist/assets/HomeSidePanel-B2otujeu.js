import{u as V,a as z}from"./preload-helper-IGrWFsVS.js";import{d as M,u as D,v as y,p as m,o as U,r as q,e as G,b as i,L as r,g as e,G as _,E as c,f as o,c as u,B as h,I as J,J as O,k as v}from"./auth-tCBxrB_D.js";import{f as C,e as E}from"./chrome-mock-BOlt1wEj.js";import{R as j}from"./ResponsiveLayout-BQBtD7HK.js";import{W as K}from"./WalletSelector-2vn644nH.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CpkLCnFh.js";const X={class:"sidepanel-header"},Y={class:"header-left"},Z={class:"wallet-info"},ee={class:"sidepanel-content"},se={class:"balance-card"},le={class:"balance-header"},te=["disabled"],ae={class:"balance-amount"},ne={class:"change-amount"},oe={class:"change-percentage"},ie={class:"action-buttons"},re={class:"tokens-section"},ce={class:"section-header"},ue={class:"section-tabs"},de={key:0,class:"token-list"},me=["onClick"],ve={class:"token-info"},ge={class:"token-logo-container"},fe={class:"token-logo-fallback"},pe={class:"token-symbol"},_e=["src","alt","onError","onLoad"],he={class:"token-details"},be={class:"token-name"},ke={class:"token-value"},we={class:"token-balance"},ye={class:"token-amount"},Ce={key:0,class:"loading-state"},We={key:1,class:"empty-state"},Se={key:1,class:"nft-list"},Le={class:"bottom-nav"},Be=M({__name:"HomeSidePanel",setup(Ee){const b=V(),a=z(),g=D(),k=y(!1),f=y(!1),d=y("tokens"),p=m(()=>a.currentWallet),W=m(()=>a.currentWalletTokens),F=m(()=>a.totalBalance),S=m(()=>p.value?a.balances[p.value.id]:null),P=m(()=>S.value?.total_value_change_24h||"0"),L=m(()=>S.value?.total_change_percentage||"0"),R=(l,s)=>{const n=parseFloat(l);return n===0?"0":n<.01?"<0.01":n.toLocaleString(void 0,{maximumFractionDigits:6})},B=l=>{const s=parseFloat(l);return s>0?"positive":s<0?"negative":"neutral"},T=l=>l.logo_url&&!l.imageError?l.logo_url:[`https://www.riftwallet.io/media/token_logos/${l.symbol.toLowerCase()}.png`,`https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/${l.token_address}/logo.png`,`https://assets.coingecko.com/coins/images/1/large/${l.symbol.toLowerCase()}.png`][0],$=(l,s)=>{console.log("Image error for token:",s.symbol,"URL:",l.target.src),s.imageError=!0},x=(l,s)=>{console.log("Image loaded for token:",s.symbol),s.imageError=!1},I=l=>{console.log("Selected token:",l)},H=()=>{console.log("Opening search...")},N=()=>{document.fullscreenElement?document.exitFullscreen().catch(l=>{console.log("Error attempting to exit fullscreen:",l)}):document.documentElement.requestFullscreen().catch(l=>{console.log("Error attempting to enable fullscreen:",l)})},A=async()=>{if(!(!p.value||f.value))try{f.value=!0,console.log("Refreshing wallet balance:",p.value.id),await a.refreshWalletBalance(p.value.id),console.log("Wallet balance refreshed successfully")}catch(l){console.error("Failed to refresh wallet balance:",l)}finally{f.value=!1}};return U(async()=>{console.log("🚀 HomeSidePanel mounted"),k.value=!0;try{console.log("📋 Auth state:",{deviceId:g.deviceId,hasPassword:g.hasPaymentPassword,sessionValid:g.isPasswordSessionValid}),g.deviceId||(console.log("⏳ Waiting for auth initialization..."),await g.initialize()),console.log("📱 Loading wallets..."),await a.loadWallets(),console.log("📱 Wallets loaded:",a.wallets.length),a.wallets.length>0&&!a.currentWallet&&(console.log("🎯 Setting current wallet:",a.wallets[0]),a.setCurrentWallet(a.wallets[0])),a.currentWallet&&(console.log("💰 Loading balance for wallet:",a.currentWallet.id),await a.loadWalletBalance(a.currentWallet.id),console.log("💰 Balance loaded:",a.totalBalance))}catch(l){console.error("❌ Failed to load wallet data:",l)}finally{k.value=!1,console.log("✅ HomeSidePanel initialization complete")}}),(l,s)=>{const n=q("router-link");return i(),G(j,{title:"Riftwallet","show-header":!0,"show-footer":!0,mode:"sidepanel",scrollable:!0},{header:r(()=>[e("div",X,[e("div",Y,[e("div",Z,[v(K)])]),e("div",{class:"header-right"},[e("button",{onClick:H,class:"header-btn",title:"Search"},s[6]||(s[6]=[e("i",{class:"ri-search-line"},null,-1)])),e("button",{onClick:N,class:"header-btn",title:"Fullscreen"},s[7]||(s[7]=[e("i",{class:"ri-fullscreen-line"},null,-1)]))])])]),footer:r(()=>[e("nav",Le,[v(n,{to:"/",class:"nav-item active"},{default:r(()=>s[17]||(s[17]=[e("i",{class:"ri-home-line"},null,-1),e("span",null,"Home",-1)])),_:1,__:[17]}),v(n,{to:"/markets",class:"nav-item"},{default:r(()=>s[18]||(s[18]=[e("i",{class:"ri-line-chart-line"},null,-1),e("span",null,"Markets",-1)])),_:1,__:[18]}),v(n,{to:"/trade",class:"nav-item"},{default:r(()=>s[19]||(s[19]=[e("i",{class:"ri-exchange-line"},null,-1),e("span",null,"Trade",-1)])),_:1,__:[19]}),v(n,{to:"/discover",class:"nav-item"},{default:r(()=>s[20]||(s[20]=[e("i",{class:"ri-compass-line"},null,-1),e("span",null,"Discover",-1)])),_:1,__:[20]}),v(n,{to:"/settings",class:"nav-item"},{default:r(()=>s[21]||(s[21]=[e("i",{class:"ri-settings-line"},null,-1),e("span",null,"Wallet",-1)])),_:1,__:[21]})])]),default:r(()=>[e("div",ee,[e("div",se,[e("div",le,[s[8]||(s[8]=e("h2",{class:"balance-title"},"Total Balance",-1)),e("button",{class:"refresh-btn",onClick:A,disabled:f.value,title:"Refresh wallet balance"},[e("i",{class:_(["ri-refresh-line",{"animate-spin":f.value}])},null,2)],8,te)]),e("div",ae,c(o(C)(F.value)),1),e("div",{class:_(["balance-change",B(L.value)])},[e("span",ne,c(o(C)(P.value)),1),e("span",oe,"("+c(o(E)(L.value))+")",1)],2)]),e("div",ie,[e("button",{class:"action-btn",onClick:s[0]||(s[0]=t=>o(b).push("/send"))},s[9]||(s[9]=[e("i",{class:"ri-send-plane-line"},null,-1),e("span",null,"Send",-1)])),e("button",{class:"action-btn",onClick:s[1]||(s[1]=t=>o(b).push("/receive"))},s[10]||(s[10]=[e("i",{class:"ri-qr-code-line"},null,-1),e("span",null,"Receive",-1)])),e("button",{class:"action-btn",onClick:s[2]||(s[2]=t=>o(b).push("/swap"))},s[11]||(s[11]=[e("i",{class:"ri-exchange-line"},null,-1),e("span",null,"Swap",-1)])),e("button",{class:"action-btn",onClick:s[3]||(s[3]=t=>o(b).push("/history"))},s[12]||(s[12]=[e("i",{class:"ri-history-line"},null,-1),e("span",null,"History",-1)]))]),e("div",re,[e("div",ce,[s[13]||(s[13]=e("h3",{class:"section-title"},"Assets",-1)),e("div",ue,[e("button",{class:_(["tab-btn",{active:d.value==="tokens"}]),onClick:s[4]||(s[4]=t=>d.value="tokens")}," Tokens ",2),e("button",{class:_(["tab-btn",{active:d.value==="nfts"}]),onClick:s[5]||(s[5]=t=>d.value="nfts")}," NFTs ",2)])]),d.value==="tokens"?(i(),u("div",de,[(i(!0),u(J,null,O(W.value,t=>(i(),u("div",{key:t.token_address,class:"token-item",onClick:w=>I(t)},[e("div",ve,[e("div",ge,[e("div",fe,[e("span",pe,c(t.symbol.charAt(0)),1)]),t.logo_url&&!t.imageError?(i(),u("img",{key:0,src:T(t),class:"token-logo",alt:t.symbol,onError:w=>$(w,t),onLoad:w=>x(w,t)},null,40,_e)):h("",!0)]),e("div",he,[e("div",be,c(t.symbol),1),e("div",ke,c(o(C)(t.balance_usd)),1)])]),e("div",we,[e("div",ye,c(R(t.balance,t.decimals)),1),e("div",{class:_(["balance-change",B(t.price_change_24h)])},c(o(E)(t.price_change_24h)),3)])],8,me))),128)),k.value?(i(),u("div",Ce,s[14]||(s[14]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Loading tokens...",-1)]))):h("",!0),!k.value&&W.value.length===0?(i(),u("div",We,s[15]||(s[15]=[e("i",{class:"ri-coins-line"},null,-1),e("p",null,"No tokens found",-1)]))):h("",!0)])):h("",!0),d.value==="nfts"?(i(),u("div",Se,s[16]||(s[16]=[e("div",{class:"empty-state"},[e("i",{class:"ri-image-line"}),e("p",null,"NFT support coming soon")],-1)]))):h("",!0)])])]),_:1})}}}),He=Q(Be,[["__scopeId","data-v-60237b02"]]);export{He as default};
