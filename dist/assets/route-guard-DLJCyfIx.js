import{u as r}from"./auth-6eK4OsPi.js";import{a as i}from"./auth-handler-CmfhYZP0.js";import"./chrome-mock-BbAbqiJG.js";function l(){return sessionStorage.getItem("isVerifyingPassword")==="true"}async function c(t,e="/"){console.log("🛡️ 执行路由守卫检查，目标路径:",e);const o=r();if(o.isAuthenticated||await o.initialize(),!o.hasPaymentPassword)return console.log("🔐 未设置密码，跳转到设置密码页面"),"/setup-password";if(!o.isPasswordSessionValid)return l()?(console.log("🔐 密码验证正在进行中，跳过路由守卫"),null):(console.log("🔐 密码会话无效，需要验证密码"),"/verify-password");if(e==="/"){const s=i();if(await s.loadWallets(),s.wallets.length===0)return console.log("💼 没有钱包，跳转到钱包选择页面"),"/wallet-choice"}return console.log("✅ 路由守卫检查通过"),null}export{l as isCurrentlyVerifying,c as routeGuard};
