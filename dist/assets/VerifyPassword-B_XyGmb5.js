import{d as f,u as P,r as c,o as y,e as w,i as o,G as p,h as _,K as S,C as V,A,M as b,n as g,f as u,y as I}from"./auth-DA2mZ09H.js";import{a as k,u as C,_ as R}from"./preload-helper-DTCqTb4O.js";import{A as W}from"./chrome-mock-BbAbqiJG.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"verify-password-page"},M={class:"header-section"},N={class:"app-name"},z={class:"form-section"},B={class:"input-group"},D={class:"input-wrapper"},T=["type"],q={key:0,class:"error-message"},F=["disabled"],G={key:0,class:"loading-spinner"},H={key:1},K=f({__name:"VerifyPassword",setup(O){console.log("ðŸ” VerifyPassword.vue - é¡µé¢å¼€å§‹åŠ è½½"),console.log("ðŸŒ å½“å‰çŽ¯å¢ƒä¿¡æ¯:",{href:window.location.href,pathname:window.location.pathname,hash:window.location.hash,windowSize:{width:window.innerWidth,height:window.innerHeight}}),console.log("ðŸ” VerifyPassword.vue - ç»„ä»¶å¼€å§‹åŠ è½½"),console.log("ðŸŒ å½“å‰çŽ¯å¢ƒä¿¡æ¯:",{href:window.location.href,pathname:window.location.pathname,windowSize:{width:window.innerWidth,height:window.innerHeight}});const n=C(),s=P(),t=k(),m=()=>{sessionStorage.removeItem("isVerifyingPassword")},l=c(""),r=c(!1),d=c(!1),i=c(""),v=async()=>{if(console.log("ðŸ” å¼€å§‹å¯†ç éªŒè¯æµç¨‹"),console.log("ðŸ“ è¾“å…¥çš„å¯†ç é•¿åº¦:",l.value.length),!l.value){console.log("âŒ å¯†ç ä¸ºç©ºï¼Œåœæ­¢éªŒè¯");return}try{d.value=!0,i.value="",console.log("ðŸ”„ è°ƒç”¨ authStore.verifyPaymentPassword"),console.log("ðŸª å½“å‰ authStore çŠ¶æ€:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid});const a=await s.verifyPaymentPassword(l.value);console.log("âœ… å¯†ç éªŒè¯ç»“æžœ:",a),a?(console.log("ðŸŽ‰ å¯†ç éªŒè¯æˆåŠŸï¼Œæ£€æŸ¥é’±åŒ…çŠ¶æ€"),console.log("ðŸ” éªŒè¯åŽçš„ authStore çŠ¶æ€:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid}),await I(),await new Promise(e=>setTimeout(e,100)),s.isPasswordSessionValid||(console.warn("âš ï¸ å¯†ç ä¼šè¯çŠ¶æ€æœªæ­£ç¡®æ›´æ–°ï¼Œé‡æ–°æ£€æŸ¥"),await s.checkPasswordSession(),await new Promise(e=>setTimeout(e,50))),console.log("ðŸ“± å¼€å§‹åŠ è½½é’±åŒ…åˆ—è¡¨"),await t.loadWallets(),console.log("ðŸ“Š é’±åŒ…åŠ è½½å®Œæˆï¼Œé’±åŒ…æ•°é‡:",t.wallets.length),console.log("ðŸ”„ æœ€ç»ˆçŠ¶æ€æ£€æŸ¥:",{hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid,walletsCount:t.wallets.length}),m(),t.wallets.length>0?(console.log("ðŸ  æœ‰é’±åŒ…ï¼Œä»Žå¯†ç éªŒè¯é¡µé¢è·³è½¬åˆ°é¦–é¡µ"),await n.replace("/"),console.log("âœ… è·¯ç”±è·³è½¬å®Œæˆ")):(console.log("ðŸ’¼ æ²¡æœ‰é’±åŒ…ï¼Œä»Žå¯†ç éªŒè¯é¡µé¢è·³è½¬åˆ°é’±åŒ…é€‰æ‹©é¡µé¢"),await n.replace("/wallet-choice"),console.log("âœ… è·¯ç”±è·³è½¬å®Œæˆ"))):(console.log("âŒ å¯†ç éªŒè¯å¤±è´¥"),i.value="Invalid password. Please try again.")}catch(a){console.error("ðŸ’¥ å¯†ç éªŒè¯è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:",a),i.value=a instanceof Error?a.message:"Verification failed"}finally{d.value=!1,console.log("ï¿½ï¿½ å¯†ç éªŒè¯æµç¨‹ç»“æŸ")}};return y(()=>{console.log("ðŸ” VerifyPassword.vue - é¡µé¢æŒ‚è½½å®Œæˆ"),console.log("ðŸª æŒ‚è½½æ—¶çš„ authStore çŠ¶æ€:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid}),console.log("ðŸ“± æŒ‚è½½æ—¶çš„ walletStore çŠ¶æ€:",{walletsCount:t.wallets.length,currentWallet:t.currentWallet}),console.log("ðŸŒ æŒ‚è½½æ—¶çš„è·¯ç”±ä¿¡æ¯:",{currentRoute:n.currentRoute.value.path,query:n.currentRoute.value.query,params:n.currentRoute.value.params})}),(a,e)=>(u(),w("div",E,[o("div",M,[e[2]||(e[2]=o("div",{class:"logo-container"},[o("img",{src:R,alt:"Riftwallet",class:"logo"})],-1)),o("h1",N,p(_(W).NAME),1),e[3]||(e[3]=o("p",{class:"form-description"}," Enter your password to access your wallet ",-1))]),o("div",z,[o("form",{onSubmit:S(v,["prevent"]),class:"password-form"},[o("div",B,[e[4]||(e[4]=o("label",{for:"password"},"Password",-1)),o("div",D,[A(o("input",{id:"password","onUpdate:modelValue":e[0]||(e[0]=h=>l.value=h),type:r.value?"text":"password",placeholder:"Enter your password",class:g(["password-input",{error:i.value}]),autofocus:""},null,10,T),[[b,l.value]]),o("button",{type:"button",onClick:e[1]||(e[1]=h=>r.value=!r.value),class:"toggle-password"},[o("i",{class:g(r.value?"ri-eye-off-line":"ri-eye-line")},null,2)])]),i.value?(u(),w("div",q,p(i.value),1)):V("",!0)]),o("button",{type:"submit",disabled:!l.value||d.value,class:"submit-btn"},[d.value?(u(),w("div",G)):(u(),w("span",H,"Verify Password"))],8,F)],32)])]))}}),L=x(K,[["__scopeId","data-v-c234a1a1"]]);export{L as default};
