import{d as g,u as m,r as c,o as y,e as u,i as e,G as p,h as P,K as _,C as S,A as V,M as b,n as v,f as w,y as A}from"./auth-BwimyXkQ.js";import{a as I,u as k,_ as C}from"./preload-helper-D1eRigLN.js";import{A as R}from"./chrome-mock-0jeXDaAI.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const x={class:"verify-password-page"},E={class:"header-section"},M={class:"app-name"},N={class:"form-section"},z={class:"input-group"},B={class:"input-wrapper"},D=["type"],q={key:0,class:"error-message"},G=["disabled"],H={key:0,class:"loading-spinner"},T={key:1},F=g({__name:"VerifyPassword",setup(K){console.log("🔐 VerifyPassword.vue - 页面开始加载"),console.log("🌐 当前环境信息:",{href:window.location.href,pathname:window.location.pathname,hash:window.location.hash,windowSize:{width:window.innerWidth,height:window.innerHeight}}),console.log("🔐 VerifyPassword.vue - 组件开始加载"),console.log("🌐 当前环境信息:",{href:window.location.href,pathname:window.location.pathname,windowSize:{width:window.innerWidth,height:window.innerHeight}});const n=k(),s=m(),i=I(),t=c(""),r=c(!1),d=c(!1),l=c(""),f=async()=>{if(console.log("🔐 开始密码验证流程"),console.log("📝 输入的密码长度:",t.value.length),!t.value){console.log("❌ 密码为空，停止验证");return}try{d.value=!0,l.value="",console.log("🔄 调用 authStore.verifyPaymentPassword"),console.log("🏪 当前 authStore 状态:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid});const a=await s.verifyPaymentPassword(t.value);console.log("✅ 密码验证结果:",a),a?(console.log("🎉 密码验证成功，检查钱包状态"),console.log("🔍 验证后的 authStore 状态:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid}),await A(),await new Promise(o=>setTimeout(o,50)),console.log("📱 开始加载钱包列表"),await i.loadWallets(),console.log("📊 钱包加载完成，钱包数量:",i.wallets.length),i.wallets.length>0?(console.log("🏠 有钱包，从密码验证页面跳转到首页"),await n.replace("/"),console.log("✅ 路由跳转完成")):(console.log("💼 没有钱包，从密码验证页面跳转到钱包选择页面"),await n.replace("/wallet-choice"),console.log("✅ 路由跳转完成"))):(console.log("❌ 密码验证失败"),l.value="Invalid password. Please try again.")}catch(a){console.error("💥 密码验证过程中发生错误:",a),l.value=a instanceof Error?a.message:"Verification failed"}finally{d.value=!1,console.log("�� 密码验证流程结束")}};return y(()=>{console.log("🔐 VerifyPassword.vue - 页面挂载完成"),console.log("🏪 挂载时的 authStore 状态:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid}),console.log("📱 挂载时的 walletStore 状态:",{walletsCount:i.wallets.length,currentWallet:i.currentWallet}),console.log("🌐 挂载时的路由信息:",{currentRoute:n.currentRoute.value.path,query:n.currentRoute.value.query,params:n.currentRoute.value.params})}),(a,o)=>(w(),u("div",x,[e("div",E,[o[2]||(o[2]=e("div",{class:"logo-container"},[e("img",{src:C,alt:"Riftwallet",class:"logo"})],-1)),e("h1",M,p(P(R).NAME),1),o[3]||(o[3]=e("p",{class:"form-description"}," Enter your password to access your wallet ",-1))]),e("div",N,[e("form",{onSubmit:_(f,["prevent"]),class:"password-form"},[e("div",z,[o[4]||(o[4]=e("label",{for:"password"},"Password",-1)),e("div",B,[V(e("input",{id:"password","onUpdate:modelValue":o[0]||(o[0]=h=>t.value=h),type:r.value?"text":"password",placeholder:"Enter your password",class:v(["password-input",{error:l.value}]),autofocus:""},null,10,D),[[b,t.value]]),e("button",{type:"button",onClick:o[1]||(o[1]=h=>r.value=!r.value),class:"toggle-password"},[e("i",{class:v(r.value?"ri-eye-off-line":"ri-eye-line")},null,2)])]),l.value?(w(),u("div",q,p(l.value),1)):S("",!0)]),e("button",{type:"submit",disabled:!t.value||d.value,class:"submit-btn"},[d.value?(w(),u("div",H)):(w(),u("span",T,"Verify Password"))],8,G)],32)])]))}}),J=W(F,[["__scopeId","data-v-a24702b0"]]);export{J as default};
