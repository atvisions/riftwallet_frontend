import{a as I}from"./preload-helper-DtVLuan9.js";import{A as U,h as k}from"./chrome-mock-0jeXDaAI.js";import{R as Y}from"./ResponsiveLayout-NikCG07L.js";import{d as O,r as h,c as b,o as H,g as R,F as T,f as l,i as s,e as i,G as g,H as C,I as F,n as D}from"./auth-DRfzTYJF.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"page-header"},P={class:"header-left"},j={class:"header-right"},K=["disabled"],W={class:"page-content"},q={key:0,class:"loading-state"},J={key:1,class:"empty-state"},V={key:2,class:"error-state"},X={key:3,class:"transactions-list"},Z={class:"date-header"},Q=["onClick"],ee={class:"transaction-icon"},te={class:"icon-container"},se=["src","alt"],oe={key:1,class:"default-icon"},ne={class:"transaction-type-indicator"},ae={key:0,class:"fas fa-arrow-up"},re={key:1,class:"fas fa-arrow-down"},le={key:2,class:"fas fa-exchange-alt"},ie={class:"transaction-info"},ce={class:"transaction-left"},ue={class:"transaction-type"},de={class:"transaction-address"},fe={class:"transaction-right"},ge={class:"transaction-time"},me=O({__name:"History",setup(he){const S=I(),u=h([]),d=h(!1),m=h(""),c=b(()=>S.currentWallet),$=b(()=>{if(!u.value||u.value.length===0)return{};const e={};return u.value.forEach(t=>{const a=t.block_time||t.timestamp||t.created_at,n=L(a);e[n]||(e[n]=[]),e[n].push(t)}),e}),p=async()=>{if(c.value){d.value=!0,m.value="";try{const e=await fetch(`${U.API_BASE_URL}/wallets/${c.value.id}/transaction_history/`,{method:"GET",headers:{"Content-Type":"application/json"}}),t=await e.json();if(!e.ok)throw new Error(t.message||"Failed to fetch transactions");u.value=t.transactions||t||[]}catch(e){m.value=e instanceof Error?e.message:"Failed to load transactions",console.error("Failed to fetch transactions:",e)}finally{d.value=!1}}},v=()=>{p()},L=e=>{if(!e)return"Unknown date";const t=new Date(typeof e=="number"?e*1e3:e),a=new Date,n=new Date(a.getFullYear(),a.getMonth(),a.getDate()),o=new Date(n.getTime()-24*60*60*1e3),r=new Date(t.getFullYear(),t.getMonth(),t.getDate());return r.getTime()===n.getTime()?"Today":r.getTime()===o.getTime()?"Yesterday":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==a.getFullYear()?"numeric":void 0})},w=e=>{if(e.token_logo&&e.token_logo.trim())return e.token_logo;const t=e.token_symbol||e.symbol||c.value?.chain;return t&&{SOL:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",ETH:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png",BNB:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/smartchain/info/logo.png",BASE:"/icons/icon128.png",KDA:"/icons/icon128.png",MATIC:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/polygon/info/logo.png",AVAX:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/avalanchec/info/logo.png",FTM:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/fantom/info/logo.png",USDC:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png",USDT:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB/logo.png",BONK:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263/logo.png"}[t.toUpperCase()]||"/icons/icon128.png"},_=e=>e.token_symbol||e.symbol||c.value?.chain||"TOKEN",f=e=>e.type?e.type.charAt(0).toUpperCase()+e.type.slice(1):e.from_address&&c.value?e.from_address.toLowerCase()===c.value.address.toLowerCase()?"Sent":"Received":"Transaction",A=e=>{const t=e.target;t.src="/icons/icon128.png"},B=e=>{switch(f(e).toLowerCase()){case"send":return"amount-negative";case"receive":return"amount-positive";default:return"amount-neutral"}},E=e=>{const t=f(e),a=_(e);if(e.amount&&e.amount.toString().includes("Fee:"))return e.amount;if(e.amount&&e.amount!=="0"&&!isNaN(parseFloat(e.amount))){const n=parseFloat(e.amount),o=t.toLowerCase()==="sent"?"-":t.toLowerCase()==="received"?"+":"";let r="";return n>=.001?r=n.toFixed(6).replace(/\.?0+$/,""):n>0?r=n.toFixed(9).replace(/\.?0+$/,""):r="0",`${o}${r} ${a}`}if(e.value&&e.value!=="0"&&!isNaN(parseFloat(e.value))){const n=parseFloat(e.value),o=t.toLowerCase()==="sent"?"-":t.toLowerCase()==="received"?"+":"";let r="";return n>=.001?r=n.toFixed(6).replace(/\.?0+$/,""):n>0?r=n.toFixed(9).replace(/\.?0+$/,""):r="0",`${o}${r} ${a}`}return e.fee&&c.value?.chain==="SOL"?`Fee: ${(e.fee/1e9).toFixed(6)} SOL`:`0 ${a}`},N=e=>{if(!c.value)return"";if(e.signature&&c.value?.chain==="SOL")return k(e.signature);const t=f(e);let a="";return t.toLowerCase()==="send"?a=e.to_address||e.recipient||"":a=e.from_address||e.sender||"",a?k(a):"Unknown"},x=e=>{if(!e)return"Unknown time";const t=new Date(typeof e=="number"?e*1e3:e);if(isNaN(t.getTime()))return"Unknown time";const n=new Date().getTime()-t.getTime(),o=Math.floor(n/(1e3*60)),r=Math.floor(n/(1e3*60*60)),y=Math.floor(n/(1e3*60*60*24));return o<1?"Just now":o<60?`${o}m ago`:r<24?`${r}h ago`:y<7?`${y}d ago`:t.toLocaleDateString()},M=e=>{console.log("View transaction detail:",e)};return H(()=>{c.value&&p()}),(e,t)=>(l(),R(Y,{title:"Transaction History","show-header":!0,"show-footer":!1,scrollable:!0,onBack:t[1]||(t[1]=a=>e.$router.go(-1))},{header:T(()=>[s("div",G,[s("div",P,[s("button",{onClick:t[0]||(t[0]=a=>e.$router.go(-1)),class:"back-button"},t[2]||(t[2]=[s("i",{class:"ri-arrow-left-line"},null,-1)])),t[3]||(t[3]=s("h1",{class:"header-title"},"Transaction History",-1))]),s("div",j,[s("button",{onClick:v,disabled:d.value,class:"refresh-button"},[s("i",{class:D(["ri-refresh-line",{spinning:d.value}])},null,2)],8,K)])])]),default:T(()=>[s("div",W,[d.value&&u.value.length===0?(l(),i("div",q,t[4]||(t[4]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Loading transactions...",-1)]))):!d.value&&u.value.length===0?(l(),i("div",J,t[5]||(t[5]=[s("i",{class:"ri-history-line"},null,-1),s("h2",null,"No Transactions",-1),s("p",null,"Your transaction history will appear here",-1)]))):m.value?(l(),i("div",V,[t[6]||(t[6]=s("i",{class:"ri-error-warning-line"},null,-1)),t[7]||(t[7]=s("h2",null,"Failed to Load",-1)),s("p",null,g(m.value),1),s("button",{onClick:v,class:"retry-button"}," Try Again ")])):(l(),i("div",X,[(l(!0),i(C,null,F($.value,(a,n)=>(l(),i("div",{key:n,class:"transaction-group"},[s("div",Z,g(n),1),(l(!0),i(C,null,F(a,o=>(l(),i("div",{key:o.signature||o.id,class:"transaction-item",onClick:r=>M(o)},[s("div",ee,[s("div",te,[w(o)?(l(),i("img",{key:0,src:w(o),alt:_(o),class:"token-icon",onError:A},null,40,se)):(l(),i("div",oe,t[8]||(t[8]=[s("i",{class:"fas fa-coins"},null,-1)])))]),s("div",ne,[f(o).toLowerCase()==="sent"?(l(),i("i",ae)):f(o).toLowerCase()==="received"?(l(),i("i",re)):(l(),i("i",le))])]),s("div",ie,[s("div",ce,[s("div",ue,g(f(o)),1),s("div",de,g(N(o)),1)]),s("div",fe,[s("div",{class:D(["transaction-amount",B(o)])},g(E(o)),3),s("div",ge,g(x(o.block_time||o.timestamp||o.created_at)),1)])])],8,Q))),128))]))),128))]))])]),_:1}))}}),ke=z(me,[["__scopeId","data-v-ea3c7630"]]);export{ke as default};
