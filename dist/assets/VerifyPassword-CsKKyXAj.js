var A=Object.defineProperty;var k=(l,e,a)=>e in l?A(l,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[e]=a;var w=(l,e,a)=>k(l,typeof e!="symbol"?e+"":e,a);import{d as C,u as R,o as h,r as u,O as B,e as g,i as s,G as P,h as E,K as I,C as x,A as M,L as $,n as V,f}from"./auth-6eK4OsPi.js";import{u as D,a as _,b as N}from"./auth-handler-CmfhYZP0.js";import{A as W}from"./chrome-mock-BbAbqiJG.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const r=class r{constructor(){w(this,"isVerifying",!1);w(this,"isNavigating",!1)}static getInstance(){return r.instance||(r.instance=new r),r.instance}setVerifying(e){this.isVerifying=e,console.log(`ðŸ” è®¾ç½®éªŒè¯çŠ¶æ€: ${e}`)}setNavigating(e){this.isNavigating=e,console.log(`ðŸ”„ è®¾ç½®å¯¼èˆªçŠ¶æ€: ${e}`)}isCurrentlyVerifying(){return this.isVerifying}isCurrentlyNavigating(){return this.isNavigating}isBusy(){return this.isVerifying||this.isNavigating}reset(){this.isVerifying=!1,this.isNavigating=!1,console.log("ðŸ”„ é‡ç½®éªŒè¯çŠ¶æ€")}};w(r,"instance");let m=r;const n=m.getInstance(),O={key:0,class:"verify-password-page"},U={class:"header-section"},z={class:"app-name"},F={class:"form-section"},K={class:"input-group"},L={class:"input-wrapper"},T=["type"],j={key:0,class:"error-message"},q=["disabled"],H={key:0,class:"loading-spinner"},J={key:1},Q={key:1,class:"redirecting-screen"},X=C({__name:"VerifyPassword",setup(l){console.log("ðŸ” VerifyPassword.vue - ç»„ä»¶åŠ è½½");const e=D(),a=R();h(async()=>{if(console.log("ðŸ” VerifyPassword ç»„ä»¶å·²æŒ‚è½½"),console.log("ðŸ” å½“å‰è·¯ç”±:",e.currentRoute.value.path),console.log("ðŸ” è®¤è¯çŠ¶æ€:",{isAuthenticated:a.isAuthenticated,hasPaymentPassword:a.hasPaymentPassword,isPasswordSessionValid:a.isPasswordSessionValid}),n.isBusy()){console.log("ðŸ” éªŒè¯æˆ–å¯¼èˆªæ­£åœ¨è¿›è¡Œä¸­ï¼Œè·³è¿‡å¤„ç†");return}if(a.isPasswordSessionValid){console.log("ðŸ” ä¼šè¯å·²æœ‰æ•ˆï¼Œç›´æŽ¥è·³è½¬åˆ°é¦–é¡µ"),y.value=!0,n.setNavigating(!0);const o=_();await o.loadWallets();const t=o.wallets.length>0?"/":"/wallet-choice";await e.replace(t);return}}),B(()=>{n.reset()});const d=u(""),v=u(!1),p=u(!1),i=u(""),y=u(!1),b=async()=>{if(!d.value){i.value="Please enter your password";return}if(n.isBusy()){console.log("ðŸ” å¯†ç éªŒè¯å·²åœ¨è¿›è¡Œä¸­ï¼Œè·³è¿‡é‡å¤éªŒè¯");return}try{if(n.setVerifying(!0),p.value=!0,i.value="",console.log("ðŸ” å¼€å§‹ç®€åŒ–å¯†ç éªŒè¯æµç¨‹"),!await a.verifyPaymentPassword(d.value)){i.value="Invalid password. Please try again.";return}console.log("âœ… å¯†ç éªŒè¯æˆåŠŸï¼Œå‡†å¤‡è·³è½¬"),y.value=!0,n.setNavigating(!0),await new Promise(S=>setTimeout(S,200));const t=_();await t.loadWallets();const c=t.wallets.length>0?"/":"/wallet-choice";console.log(`ðŸ  è·³è½¬åˆ°: ${c}`),await e.replace(c),console.log("âœ… å¯†ç éªŒè¯å’Œè·³è½¬å®Œæˆ")}catch(o){console.error("ðŸ’¥ å¯†ç éªŒè¯è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:",o),i.value=o instanceof Error?o.message:"Verification failed"}finally{n.reset(),p.value=!1}};return h(()=>{console.log("ðŸ” VerifyPassword.vue - é¡µé¢æŒ‚è½½å®Œæˆ"),console.log("ðŸª å½“å‰è®¤è¯çŠ¶æ€:",{isAuthenticated:a.isAuthenticated,hasPaymentPassword:a.hasPaymentPassword,isPasswordSessionValid:a.isPasswordSessionValid})}),(o,t)=>y.value?(f(),g("div",Q,t[5]||(t[5]=[s("div",{class:"loading-content"},[s("img",{src:N,alt:"Riftwallet",class:"loading-logo"}),s("div",{class:"loading-spinner"}),s("p",null,"Redirecting...")],-1)]))):(f(),g("div",O,[s("div",U,[t[2]||(t[2]=s("div",{class:"logo-container"},[s("img",{src:N,alt:"Riftwallet",class:"logo"})],-1)),s("h1",z,P(E(W).NAME),1),t[3]||(t[3]=s("p",{class:"form-description"}," Enter your password to access your wallet ",-1))]),s("div",F,[s("form",{onSubmit:I(b,["prevent"]),class:"password-form"},[s("div",K,[t[4]||(t[4]=s("label",{for:"password"},"Password",-1)),s("div",L,[M(s("input",{id:"password","onUpdate:modelValue":t[0]||(t[0]=c=>d.value=c),type:v.value?"text":"password",placeholder:"Enter your password",class:V(["password-input",{error:i.value}]),autofocus:""},null,10,T),[[$,d.value]]),s("button",{type:"button",onClick:t[1]||(t[1]=c=>v.value=!v.value),class:"toggle-password"},[s("i",{class:V(v.value?"ri-eye-off-line":"ri-eye-line")},null,2)])]),i.value?(f(),g("div",j,P(i.value),1)):x("",!0)]),s("button",{type:"submit",disabled:!d.value||p.value,class:"submit-btn"},[p.value?(f(),g("div",H)):(f(),g("span",J,"Verify Password"))],8,q)],32)])]))}}),as=G(X,[["__scopeId","data-v-edf56e64"]]);export{as as default};
