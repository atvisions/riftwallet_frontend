import{d as g,u as m,r as c,o as y,e as u,i as e,G as p,h as P,K as _,C as S,A as V,M as A,n as v,f as w}from"./auth-DRfzTYJF.js";import{a as b,u as I,_ as C}from"./preload-helper-DtVLuan9.js";import{A as W}from"./chrome-mock-0jeXDaAI.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"verify-password-page"},E={class:"header-section"},M={class:"app-name"},x={class:"form-section"},N={class:"input-group"},z={class:"input-wrapper"},B=["type"],D={key:0,class:"error-message"},q=["disabled"],G={key:0,class:"loading-spinner"},H={key:1},F=g({__name:"VerifyPassword",setup(K){console.log("🔐 VerifyPassword.vue - 页面开始加载"),console.log("🌐 当前环境信息:",{href:window.location.href,pathname:window.location.pathname,hash:window.location.hash,windowSize:{width:window.innerWidth,height:window.innerHeight}}),console.log("🔐 VerifyPassword.vue - 组件开始加载"),console.log("🌐 当前环境信息:",{href:window.location.href,pathname:window.location.pathname,windowSize:{width:window.innerWidth,height:window.innerHeight}});const i=I(),s=m(),t=b(),l=c(""),r=c(!1),d=c(!1),n=c(""),f=async()=>{if(console.log("🔐 开始密码验证流程"),console.log("📝 输入的密码长度:",l.value.length),!l.value){console.log("❌ 密码为空，停止验证");return}try{d.value=!0,n.value="",console.log("🔄 调用 authStore.verifyPaymentPassword"),console.log("🏪 当前 authStore 状态:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid});const a=await s.verifyPaymentPassword(l.value);console.log("✅ 密码验证结果:",a),a?(console.log("🎉 密码验证成功，检查钱包状态"),console.log("🔍 验证后的 authStore 状态:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid}),await new Promise(o=>setTimeout(o,50)),console.log("📱 开始加载钱包列表"),await t.loadWallets(),console.log("📊 钱包加载完成，钱包数量:",t.wallets.length),t.wallets.length>0?(console.log("🏠 有钱包，从密码验证页面跳转到首页"),console.log("🎯 当前钱包:",t.currentWallet),await i.replace("/"),console.log("✅ 路由跳转完成")):(console.log("💼 没有钱包，从密码验证页面跳转到钱包选择页面"),await i.replace("/wallet-choice"),console.log("✅ 路由跳转完成"))):(console.log("❌ 密码验证失败"),n.value="Invalid password. Please try again.")}catch(a){console.error("💥 密码验证过程中发生错误:",a),n.value=a instanceof Error?a.message:"Verification failed"}finally{d.value=!1,console.log("🏁 密码验证流程结束")}};return y(()=>{console.log("🔐 VerifyPassword.vue - 页面挂载完成"),console.log("🏪 挂载时的 authStore 状态:",{isAuthenticated:s.isAuthenticated,deviceId:s.deviceId,hasPaymentPassword:s.hasPaymentPassword,isPasswordSessionValid:s.isPasswordSessionValid}),console.log("📱 挂载时的 walletStore 状态:",{walletsCount:t.wallets.length,currentWallet:t.currentWallet}),console.log("🌐 挂载时的路由信息:",{currentRoute:i.currentRoute.value.path,query:i.currentRoute.value.query,params:i.currentRoute.value.params})}),(a,o)=>(w(),u("div",R,[e("div",E,[o[2]||(o[2]=e("div",{class:"logo-container"},[e("img",{src:C,alt:"Riftwallet",class:"logo"})],-1)),e("h1",M,p(P(W).NAME),1),o[3]||(o[3]=e("p",{class:"form-description"}," Enter your password to access your wallet ",-1))]),e("div",x,[e("form",{onSubmit:_(f,["prevent"]),class:"password-form"},[e("div",N,[o[4]||(o[4]=e("label",{for:"password"},"Password",-1)),e("div",z,[V(e("input",{id:"password","onUpdate:modelValue":o[0]||(o[0]=h=>l.value=h),type:r.value?"text":"password",placeholder:"Enter your password",class:v(["password-input",{error:n.value}]),autofocus:""},null,10,B),[[A,l.value]]),e("button",{type:"button",onClick:o[1]||(o[1]=h=>r.value=!r.value),class:"toggle-password"},[e("i",{class:v(r.value?"ri-eye-off-line":"ri-eye-line")},null,2)])]),n.value?(w(),u("div",D,p(n.value),1)):S("",!0)]),e("button",{type:"submit",disabled:!l.value||d.value,class:"submit-btn"},[d.value?(w(),u("div",G)):(w(),u("span",H,"Verify Password"))],8,q)],32)])]))}}),j=k(F,[["__scopeId","data-v-4555a0af"]]);export{j as default};
